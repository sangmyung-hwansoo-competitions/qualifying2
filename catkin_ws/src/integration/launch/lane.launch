<launch>
    <arg name="host" default="$(env HOSTIP)" />
    <arg name="port" default="2000" />

    <arg name="camera_sensor_x" default="0.0" />
    <arg name="camera_sensor_y" default="0.0" />
    <arg name="camera_sensor_z" default="2.5" />
    <arg name="lidar_sensor_x" default="0.0" />
    <arg name="lidar_sensor_y" default="0.0" />
    <arg name="lidar_sensor_z" default="3.0" />
   
   <param name="use_sim_time" value="false" />
   
   <!-- Main Carla Node -->
    <node pkg="carla_ctl" type="carla_ctl" name="carla_ctl" output="screen">
        <param name="camera_sensor_x" value="$(arg camera_sensor_x)" />
        <param name="camera_sensor_y" value="$(arg camera_sensor_y)" />
        <param name="camera_sensor_z" value="$(arg camera_sensor_z)" />
        <param name="lidar_sensor_x" value="$(arg lidar_sensor_x)" />
        <param name="lidar_sensor_y" value="$(arg lidar_sensor_y)" />
        <param name="lidar_sensor_z" value="$(arg lidar_sensor_z)" />
        <param name="host" value="$(arg host)" />
        <param name="port" value="$(arg port)" />
      
      <!-- resolution -->
      <param name="camera_resolution_x" value="640" />
      <param name="camera_resolution_y" value="480" />
    </node>
   
   <!-- image processing node -->
   <node pkg="lane_detection" type="lane_detection.py" name="image_preprocessor" output="screen"/>
   
   <!-- PyGame controls -->
    <node pkg="control" type="teleop_keyboard.py" name="control_keyboard" output="screen" 
      args="--host $(arg host) --port $(arg port) --res '640x480'" />
   
   <!-- Trajectory path -->
    <node pkg="hector_trajectory_server" type="hector_trajectory_server" name="trajectory_server_orb_slam3" output="screen" ns="orb_slam3_ros" >
        <param name="/target_frame_name" value="/world" />
        <param name="/source_frame_name" value="/camera" />
        <param name="/trajectory_update_rate" value="20.0" />
        <param name="/trajectory_publish_rate" value="20.0" />
    </node>
   
    <!-- Visualization - RViz -->
   <!-- args="-d $(find orb_slam3_ros)/config/orb_slam3_no_imu.rviz" -->
    <node name="rviz" pkg="rviz" type="rviz" args="-d $(find visualization)/rviz/lane_detection.rviz" output="screen" />
</launch>